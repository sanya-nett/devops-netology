# ДЗ 6.6. Troubleshooting

1) MongoDB

Пользователь (разработчик) написал в канал поддержки, что у него уже 3 минуты происходит 
   CRUD операция в MongoDB и её нужно прервать.
   
Чтобы решить проблему сейчас, найду запрос пользователя, который идет больше 3-х минут  
Сохраню его для последующего исследования (+системные метрики), а сейчас либо прибью запрос пользователя
(возможно все долгие запросы)

В будущем установил бы `maxTimeMS` до ожидаемого времени ответа


2) Redis

Вы запустили инстанс Redis для использования совместно с сервисом, 
который использует механизм TTL. Причем отношение количества записанных 
key-value значений к количеству истёкших значений есть величина постоянная 
и увеличивается пропорционально количеству реплик сервиса.

Не успевает очистить истекшие ключи, из-за большой нагрузки и создает lock на запись
так как редис однопоточный

3) MySQL 

Вы подняли базу данных MySQL для использования в гис-системе. При росте количества записей, 
в таблицах базы, пользователи начали жаловаться на ошибки вида:

`InterfaceError: (InterfaceError) 2013: Lost connection to MySQL server during query u'SELECT..... '`  
Как вы думаете, почему это начало происходить и как локализовать проблему?
Либо слишком долгий запрос, либо закончилось конекшены к базе

Какие пути решения данной проблемы вы можете предложить?
Разово накинуть мощностей, или конекшенов, либо оптимизировать запрос

4) PostgreSQL

Вы решили перевезти гис-систему из задачи 3 на PostgreSQL, так как прочитали в документации, что эта СУБД работает с большим объемом данных лучше, чем MySQL.

После запуска пользователи начали жаловаться, что СУБД время от времени становится недоступной. В dmesg вы видите, что:

`postmaster invoked oom-killer`

Как вы думаете, что происходит?
Не хватает оперативы обработать текущие запросы, возможно это большая транзакция

Как бы вы решили данную проблему?
Изначально накинул бы оперативы, но лучше оптимизировал запрос (индекс и тп)

